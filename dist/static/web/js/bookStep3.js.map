{"version":3,"sources":["webpack:///./src/pages/bookStep3/index.js","webpack:///./src/pages/bookStep3/index.less","webpack:///./src/pages/bookStep3/templates/majorList.ejs","webpack:///./src/pages/bookStep3/templates/majorDetail.ejs"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2C;;AAEA;AACA,UAAS;AACT,IAAG;AACH,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;;AAEL;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;AACH,GAAE;;AAEF;AACA;;AAEA;AACA;;AAEA;AACA,GAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH,qB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH,GAAE;;AAEF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA,UAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,IAAG;AACH,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,GAAE;;AAEF;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;;;AAGH;;AAEA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;;;AAGA;;;;;;;;;AChQA,0C;;;;;;;ACAA;AACA,iBAAgB;AAChB;AACA,mBAAkB;AAClB;;AAEA,kCAAiC;AACjC;AACA,iBAAgB,yBAAyB,OAAO;AAChD;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA,GAAE,oBAAoB;AACtB;AACA,iBAAgB,yBAAyB,OAAO;AAChD;AACA,oB;AACA,qC;AACA,8B;AACA,KAAI,K;AACJ,uB;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA,GAAE;;;AAGF;AACA;AACA,E;;;;;;;ACzEA;AACA,iBAAgB;AAChB;AACA,mBAAkB;AAClB;AACA,8GAA6G;AAC7G;AACA,aAAY;AACZ,iBAAgB,iBAAiB,OAAO;AACxC;AACA;AACA;AACA,GAAE;AACF;;AAEA;AACA;AACA,E","file":"static/web/js/bookStep3.js","sourcesContent":["/* 建议这里都引入 */\nrequire('../../assets/less/common.less');\nrequire('./index.less');\nvar $ = window.$ || require(\"jquery\");\n\n//工具类方法\nvar util = require(\"../../assets/components/util\");\n\n//公共方法\nvar common = require(\"../../assets/components/common\");\n\n//自定义功能写下面\nvar tmpl_list = require(\"./templates/majorList.ejs\");\nvar tmpl_subMajor = require(\"./templates/majorDetail.ejs\");\n//require(\"../../assets/components/validator\");\n\n//弹窗模板\nvar tmpl_detail = require(\"../../assets/templates/detail.ejs\");\nvar tmpl_questions = require(\"../../assets/templates/questions.ejs\");\n\nvar browser = require(\"../../assets/components/browser\");\n\nvar Cookie = require(\"js-cookie\");\n\nvar provinceId = $(\"[name=province]\").val();\nvar batch = $(\"[name=batch]\").val();\n\nvar userId =  $(\"[name=userId]\").val();\n\nvar isModernBrower = browser.isModernBrower;\n\nvar majors = {\n\n\tinit : function(){\n\t\tthis.detailTrigger();\n\t\tthis.requestData();\n\t},\n\n\tdetailTrigger : function(){\n\t\t//详情弹窗\n\t\t$(\"[data-trigger]\").on(\"click\",function(e){\n\t\t    e.preventDefault();\n\t\t    var btn = $(e.target).closest(\".trigger\");\n\t\t    var tmpl = btn.data(\"trigger\") == \"detail\" ? tmpl_detail : tmpl_questions;\n\n\t\t    modalBox( btn.get(0), {\n\t\t          html:tmpl(),\n\t\t          klass : 'w540 shadow',\n\t\t          closeByOverlay : false,\n\t\t          completeCallback : function(){ \n\t\t            \n\t\t          }\n\t\t      });\n\t\t});\n\t},\n\n\trequestData : function(){\n\t\tvar that = this;\n\t\t$.ajax({\n\t\t\turl : preServer+provinceId + \"/data/major/all\",\n\t\t\ttype : \"get\",\n\t\t\tsuccess : function(res){\n\t\t\t\tif(typeof rs == \"string\"){\n\t\t\t\t\tvar res = $.parseJSON(res);\n\t\t\t\t}\n\n\t\t\t\n\t\t\t\tif(res.code!=1){\n\t\t\t\t\twarn(res.msg);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tres.result.batch = batch;\n\t\t\t\tthat.res = res.result;\n\n\t\t\t\t//读取选择项\n\t\t\t\tvar selectList = [];\n\t\t\t\tif(!!Cookie.get(userId)){\n\t\t\t\t\tselectList = Cookie.get(userId).split(\"&\");\n\t\t\t\t}\n\n\t\t\t\t//遍历结果列表\n\t\t\t\t$.each(that.res.subs,function(m,l){\n\t\t\t\t\t$.each(l.subs,function(n,k){\n\t\t\t\t\t\tif(selectList.indexOf(k.id) != \"-1\"){\n\t\t\t\t\t\t\tk.status = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\t\tthat.insertData(res.result);\n\n\t\t\t},\n\t\t\terror : function(err){\n\t\t\t\tconsole.log(err);\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t},\n\n\tinsertData : function(res){\n\t\tvar that = this;\n\n\t\t$(\"#caseFormWrapper\").removeClass(\"preloading\");\n\t\t$(\"#majorSelectWrapper\").empty().html(tmpl_list(res));\n\n\t\tthis.bindEvt();\n\t},\n\n\tbindEvt : function(){\n\t\tvar that = this;\n\n\t\t// $(\"#caseForm_3\").validator({\n\t\t// \tautoDisabled : true,\n\t\t// \tautoValidate : true,\n\t\t// \tonSubmitActive : true\n\t\t// });\n\t\t\n\t\t//checkbox定制\n\t\t$('.label_check').on(\"click\",function(e){\n\t\t  e.stopPropagation();\n\t\t  \n\t\t  var target = $(e.target);\n\t\t  var label = $(this).closest(\"label\");\n\t\t  if(target.is(\".icon-eye\")){\n\t\t  \te.preventDefault();\n\t\t  \tthat.subMajorModal(target);\n\t\t  }else{\n\t\t  \tif(!isModernBrower){\n\t\t  \t\tif (label.attr(\"for\") != \"\"){\n\t\t\t        $(\"#\" + label.attr(\"for\")).trigger(\"click\");\n\t\t\t        util.setupLabel();\n\t\t  \t\t}\n\t\t  \t}\n\t\t  }\n\t\t});\n\n\t\tutil.setupLabel();\t\t\n\n\t\t$(\"#nBtn\").on(\"click\",function(e){\n\t\t\te.preventDefault();\n\t\t\tvar btn = $(this).closest(\".btn\");\n\t\t\tif(btn.hasClass(\"disabled\")) return;\n\t\t\tbtn.addClass('disabled');\n\n\t\t\tthat.submitFunc.call(that,btn);\n\t\t});\n\t},\n\n\tsubmitFunc : function(btn){\n\t\tvar that = this;\n\n\t\tvar eleBoxs=$('input[type=checkbox][name=majorType]'),\n\t\t\tboxList = [],\n\t        selectAll = true;\n\n\t    eleBoxs.each(function(){\n          if($(this).prop(\"checked\")){\n            selectAll=false;\n          }\n\t    });\n\n\t    // if(selectAll){\n\t    // \tboxList = eleBoxs;\n\t    // }else{\n\t     \tboxList = $('input[type=checkbox][name=majorType]:checked');\n\t    // }\n\n\t    var majorList = that.selectList(boxList);\n\n\t    //保存到cookie里面\n\t    var cookieList = $.map(majorList,function(c){\n\t    \treturn c.majorId;\n\t    })\n\n\t    //保存选择\n\t    var majorSelectList = (cookieList.length > 0) ? cookieList.join(\"&\") : 0;\n\t    Cookie.set(userId,majorSelectList);\n\n\t\tvar _data = {\n\t\t\tmajorList : majorList\n\t\t};\n\n\t\t$.ajax({\n\t\t\turl : preServer+provinceId+\"/tzy/plan/wishes/step3\",\n\t\t\ttype : \"post\",\n            contentType: \"application/json\",\n            data : JSON.stringify(_data),\n            success : function(res){\n                if(typeof res == \"string\"){\n                    var res = $.parseJSON(res);\n                }\n\n                if(res.code==1){\n                    window.location = \"/box/plan/book_step4\";\n                    return false;\n                }else{\n                    warn(res.msg);\n                    btn.removeClass(\"disabled\");\n                    return false;\n                }\n            },\n            error : function(err){\n            \tbtn.removeClass(\"disabled\");\n                console.log(err);\n            }\n\t\t})\n\t},\n\n\tselectList : function(eleBoxs){\n\t\treturn $.map(eleBoxs,function(ele,idx){\n    \t\tvar icon = $(ele).siblings(\"[data-majorid]\");\n    \t\treturn {\n    \t\t\t\"majorId\":icon.data(\"majorid\"),\n    \t\t\t\"majorName\":icon.data(\"name\")\n    \t\t};\n    \t});\n\t},\n\n\tsubMajorModal :function(btn){\n\t\tvar that = this;\n\n\t\tvar supId = btn.data(\"suptype\"),\n\t\t\tmajorId = btn.data(\"majorid\");\n\n\t\tvar subList1 = $.grep(that.res.subs,function(e,i){\n\t\t\tif(e.id == supId){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\n\t\t//var idx = (batch==3) ? 1 : 0;\n\n\t\tvar subList = $.grep(subList1[0].subs,function(e,i){\n\t\t\tif(e.id == majorId){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\tvar detailData = {\n\t\t\tname : btn.data(\"name\"),\n\t\t\tlist : subList[0].subs\n\t\t};\n\n\t\tmodalBox( btn, {\n\t\t        html:tmpl_subMajor(detailData),\n\t\t        klass : 'w540 shadow',\n\t\t        closeByOverlay : true,\n\t\t        completeCallback : function(){}\n\t\t});\n\t}\n\n};\n\n\nmajors.init();\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/pages/bookStep3/index.js\n ** module id = 0\n ** module chunks = 8\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/pages/bookStep3/index.less\n ** module id = 139\n ** module chunks = 8\n **/","module.exports = function (obj) {\nobj || (obj = {});\nvar __t, __p = '', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\nwith (obj) {\n\n if (batch == 1 || batch == 2 ) { ;\n__p += '\\n<div class=\"row\">\\n\t<p class=\"g6 mb12\">本科大类：</p>\\n\\n\t';\n for (var i = 0; i < subs[0].subs.length; i++) { ;\n__p += '\\n\t\t';\n var checkedStatus;\n\t\t if(subs[0].subs[i].status == 1) {\n\t\t\tcheckedStatus = \"checked\";\n\t\t }else{\n\t\t\tcheckedStatus = \"\";\n\t\t } ;\n__p += '\\n\t<label class=\"label_check\" for=\"majorType' +\n((__t = ( subs[0].id )) == null ? '' : __t) +\n'_' +\n((__t = ( subs[0].subs[i].id )) == null ? '' : __t) +\n'\">\\n\t\t<em class=\"icon-eye\" data-supType=' +\n((__t = ( subs[0].id )) == null ? '' : __t) +\n' data-majorId=' +\n((__t = ( subs[0].subs[i].id )) == null ? '' : __t) +\n' data-name=\"' +\n((__t = ( subs[0].subs[i].name )) == null ? '' : __t) +\n'\" ></em>\\n\t\t<input type=\"checkbox\" class=\"input form-control\" id=\"majorType' +\n((__t = ( subs[0].id )) == null ? '' : __t) +\n'_' +\n((__t = ( subs[0].subs[i].id )) == null ? '' : __t) +\n'\" name=\"majorType\" ' +\n((__t = ( checkedStatus )) == null ? '' : __t) +\n' required>\\n\t\t<em class=\"vm\">' +\n((__t = ( subs[0].subs[i].name )) == null ? '' : __t) +\n'</em>\\n\t\t<em class=\"icon-yes\">\\n\t\t\t<i></i>\\n\t\t</em>\\n\t</label>\\n\t';\n } ;\n__p += '\\n</div>\\n';\n }else if(batch == 3){ ;\n__p += '\\n<div class=\"row\">\\n\t<p class=\"g6 mb12\">专科大类：</p>\\n\\n\t';\n for (var m = 0; m < subs[1].subs.length; m++) { ;\n__p += '\\n\t\t';\n var checkedStatus; \n\t\t if(subs[1].subs[m].status == 1) { \n\t\t\tcheckedStatus = \"checked\"; \n\t\t }else{ \n\t\t\tcheckedStatus = \"\"; \n\t\t } ;\n__p += '\\n\t<label class=\"label_check\" for=\"majorType' +\n((__t = ( subs[1].id )) == null ? '' : __t) +\n'_' +\n((__t = ( subs[1].subs[m].id )) == null ? '' : __t) +\n'\">\\n\t\t<em class=\"icon-eye\" data-supType=' +\n((__t = ( subs[1].id )) == null ? '' : __t) +\n' data-majorId=' +\n((__t = ( subs[1].subs[m].id )) == null ? '' : __t) +\n' data-name=\"' +\n((__t = ( subs[1].subs[m].name )) == null ? '' : __t) +\n'\" ></em>\\n\t\t<input type=\"checkbox\" class=\"input form-control\" id=\"majorType' +\n((__t = ( subs[1].id )) == null ? '' : __t) +\n'_' +\n((__t = ( subs[1].subs[m].id )) == null ? '' : __t) +\n'\" name=\"majorType\" ' +\n((__t = ( checkedStatus )) == null ? '' : __t) +\n' required>\\n\t\t<em class=\"vm\">' +\n((__t = ( subs[1].subs[m].name )) == null ? '' : __t) +\n'</em>\\n\t\t<em class=\"icon-yes\">\\n\t\t\t<i></i>\\n\t\t</em>\\n\t</label>\\n\t';\n } ;\n__p += '\\n</div>\\n';\n } ;\n\n\n}\nreturn __p\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/pages/bookStep3/templates/majorList.ejs\n ** module id = 142\n ** module chunks = 8\n **/","module.exports = function (obj) {\nobj || (obj = {});\nvar __t, __p = '', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\nwith (obj) {\n__p += '<div class=\"modalCntWrap taoModal g9 majorListModal\">\\n <h3 class=\"clearfix\">\\n <a href=\"javascript:;\" class=\"icons btn-close fr\"></a>\\n <span class=\"fl\"><em class=\"majorName\">' +\n((__t = ( name )) == null ? '' : __t) +\n'</em>&nbsp;包含的专业</span>\\n</h3>\\n\\n<div class=\"majorListWrap\">\\n  <div class=\"majorList\">\\n  \t  ';\n for (var i = 0; i < list.length; i++) { ;\n__p += '\\n      <span class=\"btn btn-default btn-list\">' +\n((__t = ( list[i].name )) == null ? '' : __t) +\n'</span>\\n      ';\n } ;\n__p += '\\n  </div>\\n</div>\\n\\n</div>';\n\n}\nreturn __p\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/pages/bookStep3/templates/majorDetail.ejs\n ** module id = 143\n ** module chunks = 8\n **/"],"sourceRoot":""}